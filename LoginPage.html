<!DOCTYPE html>
<html>
<head>
    <title>Fog &amp; Flame</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&amp;display=swap" rel="stylesheet"/>
    <style>
        .hover-scale:hover {
            transform: scale(1.05);
            transition: transform 0.3s ease;
        }
    </style>
</head>
<body class="bg-gray-100 font-roboto">
<header class="bg-black text-white p-4 flex justify-between items-center">
    <div class="text-xl font-bold flex items-center">
        Fog &amp; Flame
    </div>
    <nav class="flex gap-6">
        <a class="nav-item hover:text-gray-300 transition-colors duration-300" id="home-btn" href="HomePage.html">Home</a>
        <a class="nav-item hover:text-gray-300 transition-colors duration-300" id="menu-btn" href="MenuPage.html">Menu</a>
        <a class="nav-item hover:text-gray-300 transition-colors duration-300" id="contact-btn" href="contact.html">Contact</a>
    </nav>
</header>

<main class="flex flex-col items-center justify-center min-h-screen py-8">
    <h1 class="text-4xl font-bold mt-8 text-center">
        Welcome to Fog &amp; Flame
    </h1>
    <p class="text-gray-600 mt-2 mb-2 text-center max-w-lg">
        Where culinary artistry meets comfort. Experience our fusion cuisine, handcrafted chocolates, and signature cocktails.
    </p>

    <div class="flex flex-wrap justify-center gap-6 mt-8 w-full max-w-4xl px-4">
        <div class="bg-white p-8 rounded-lg shadow-md w-full max-w-md hover-scale transition-all duration-300">
            <h2 class="text-2xl font-bold mb-4 flex items-center">
                <i class="fas fa-user-circle mr-2 text-gray-700"></i>
                Member Login
            </h2>
            <form id="login-form">
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">
                        <i class="fas fa-envelope mr-2"></i>Email
                    </label>
                    <input id="login-email" class="w-full p-3 border rounded focus:outline-none focus:ring-2 focus:ring-black" placeholder="Enter your email" type="email" required/>
                </div>
                <div class="mb-6">
                    <label class="block text-gray-700 mb-2">
                        <i class="fas fa-lock mr-2"></i>Password
                    </label>
                    <div class="relative">
                        <input id="login-password" class="w-full p-3 border rounded focus:outline-none focus:ring-2 focus:ring-black" placeholder="Enter your password" type="password" required/>
                        <button type="button" id="toggle-password" class="absolute inset-y-0 right-0 pr-3 flex items-center text-sm leading-5">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <a href="#" class="text-sm text-gray-600 hover:text-black mt-2 inline-block">Forgot password?</a>
                </div>
                <button class="w-full bg-black text-white p-3 rounded hover:bg-gray-800 transition-colors duration-300 flex justify-center items-center" type="submit">
                    <i class="fas fa-sign-in-alt mr-2"></i>Log In
                </button>
                <p class="text-center mt-4 text-gray-600">
                    Don't have an account? <a href="SignUpPage.html" class="text-black font-bold hover:underline">Sign up</a>
                </p>
            </form>
        </div>

        <div class="bg-white p-8 rounded-lg shadow-md w-full max-w-md hover-scale transition-all duration-300">
            <h2 class="text-2xl font-bold mb-4 flex items-center">
                <i class="fas fa-utensils mr-2 text-gray-700"></i>
                Continue as Guest
            </h2>
            <p class="text-gray-600 mb-6">
                Explore our award-winning menu, make reservations, and enjoy our special offers without creating an account.
            </p>
            <div class="space-y-4">
                <div class="flex items-center">
                    <i class="fas fa-check-circle text-green-500 mr-2"></i>
                    <span>Browse our seasonal menu</span>
                </div>
                <div class="flex items-center">
                    <i class="fas fa-check-circle text-green-500 mr-2"></i>
                    <span>Place orders for takeout</span>
                </div>
                <div class="flex items-center">
                    <i class="fas fa-check-circle text-green-500 mr-2"></i>
                    <span>Make table reservations</span>
                </div>
            </div>
            <button id="guest-btn" class="w-full border-2 border-black text-black p-3 rounded mt-6 hover:bg-black hover:text-white transition-colors duration-300 flex justify-center items-center">
                <i class="fas fa-arrow-right mr-2"></i>Continue as Guest
            </button>
        </div>
    </div>

    <div class="mt-12 text-center max-w-lg">
        <h3 class="text-xl font-bold mb-4">Today's Specials</h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 p-4">
            <div class="bg-white p-4 rounded shadow-sm">
                <i class="fas fa-cookie text-yellow-600 text-2xl mb-2"></i>
                <h4 class="font-bold">Chocolate Truffle</h4>
                <p class="text-sm text-gray-600">Handcrafted with Belgian chocolate</p>
            </div>
            <div class="bg-white p-4 rounded shadow-sm">
                <i class="fas fa-fish text-blue-600 text-2xl mb-2"></i>
                <h4 class="font-bold">Signature Sushi</h4>
                <p class="text-sm text-gray-600">Fresh daily seafood selection</p>
            </div>
            <div class="bg-white p-4 rounded shadow-sm">
                <i class="fas fa-pizza-slice text-red-600 text-2xl mb-2"></i>
                <h4 class="font-bold">Truffle Pasta</h4>
                <p class="text-sm text-gray-600">With seasonal mushrooms</p>
            </div>
        </div>
    </div>
</main>

<footer class="bg-black text-white p-6 mt-12">
    <div class="flex flex-col md:flex-row justify-between items-center">
        <div class="text-lg font-bold mb-4 md:mb-0">
            Fog &amp; Flame
        </div>
        <div class="flex gap-4">
            <a href="#" class="hover:text-gray-300"><i class="fab fa-facebook"></i></a>
            <a href="#" class="hover:text-gray-300"><i class="fab fa-instagram"></i></a>
            <a href="#" class="hover:text-gray-300"><i class="fab fa-twitter"></i></a>
        </div>
        <div class="mt-4 md:mt-0 text-sm">
            &copy; 2025 Fog &amp; Flame. All rights reserved.
        </div>
    </div>
</footer>

<script type="module">
    // Import Supabase client
    import { supabase } from './frontend/src/supabaseClient.js';

    // Password hashing function (same as in signup)
    async function hashPassword(password) {
        const encoder = new TextEncoder();
        const data = encoder.encode(password);
        const hashBuffer = await crypto.subtle.digest('SHA-256', data);
        const hashArray = Array.from(new Uint8Array(hashBuffer));
        const hashHex = hashArray.map(byte => byte.toString(16).padStart(2, '0')).join('');
        return hashHex;
    }

    // Login form submission
    document.getElementById('login-form').addEventListener('submit', async function(event) {
        event.preventDefault();

        const email = document.getElementById('login-email').value;
        const password = document.getElementById('login-password').value;

        // Validate email and password
        if (!email || !password) {
            alert('Please enter both email and password.');
            return;
        }

        // Check if the user exists in the database
        const { data: userData, error: userError } = await supabase
            .from('users')
            .select('*')
            .eq('email', email)
            .single();

        if (userError || !userData) {
            alert('No account found with this email. Please sign up.');
            return;
        }

        // Verify the password
        const hashedPassword = await hashPassword(password);
        if (hashedPassword !== userData.password_hash) {
            alert('Incorrect password. Please try again.');
            return;
        }

        // If credentials are valid, log the user in
        alert('Login successful! Redirecting to the home page...');
        window.location.href = 'HomePage.html'; // Redirect to the home page
    });

    // Toggle password visibility
    document.getElementById('toggle-password').addEventListener('click', function() {
        const passwordInput = document.getElementById('login-password');
        const toggleButton = document.getElementById('toggle-password');

        if (passwordInput.type === 'password') {
            passwordInput.type = 'text';
            toggleButton.innerHTML = '<i class="fas fa-eye-slash"></i>';
        } else {
            passwordInput.type = 'password';
            toggleButton.innerHTML = '<i class="fas fa-eye"></i>';
        }
    });
</script>
</body>
</html>